export type Lang = "zh" | "en";

const KEY = "llm-data-lab.lang";
export const LANG_UPDATED_EVENT = "lang-updated";

export function readLang(): Lang {
  if (typeof window === "undefined") return "zh";
  const v = localStorage.getItem(KEY);
  return v === "en" ? "en" : "zh";
}

export function writeLang(lang: Lang) {
  if (typeof window === "undefined") return;
  localStorage.setItem(KEY, lang);
  window.dispatchEvent(new Event(LANG_UPDATED_EVENT));
}

export const workspaceTexts = {
  zh: {
    title: "科研数据工作台",
    desc: "上传数据集、描述任务、选择模型生成可执行代码，并在安全沙箱中运行。",
    taskDesc: "任务描述",
    chooseModel: "选择模型",
    analysisType: "分析类型",
    dataset: "数据集",
    pickData: "选择数据",
    noFile: "未选择文件",
    pyCode: "Python 代码",
    runNow: "立即执行",
    running: "执行中...",
    execResult: "执行结果",
    status: "状态",
    stdout: "标准输出",
    stderr: "错误日志",
    artifacts: "生成的图表/附件",
    view: "查看",
    waiting: "等待执行。",
    reqFailed: "请求失败",
    providerFailed: "模型列表获取失败",
    noMatchModel: "没有匹配的模型",
    defaultModel: "默认模型",
    defaultHint: "未配置供应商凭证时，可使用“默认模型”（需后端已配置 OPENAI_API_KEY）",
    // extra
    configModelFirst: "请先在设置页面配置模型后再使用工作台。",
    unnamed: "未命名分析",
    needCode: "请先生成或填写 Python 代码。",
    configModelForChat: "请先在设置页面配置模型。",
    patchCannotMerge: "智能协作提供的修改无法自动合并，请手动调整。",
    needProviderModels: "请先在设置页面为各模型提供商填写默认模型。",
    previewShow: "显示数据预览",
    previewHide: "隐藏数据预览",
    previewToggleShow: "查看",
    previewToggleHide: "隐藏",
    uploaded: "已上传：",
    rowsLabel: "行",
    colsLabel: "列",
    csvSupport: "支持 CSV / Excel 文件",
    generating: "生成中...",
    genCode: "生成 Python 代码",
    taskIdLbl: "任务 ID：",
    noOutput: "(无输出)",
  },
  en: {
    title: "Research Workspace",
    desc: "Upload a dataset, describe tasks, pick a model to generate runnable code and execute it in a sandbox.",
    taskDesc: "Task Description",
    chooseModel: "Model",
    analysisType: "Analysis Type",
    dataset: "Dataset",
    pickData: "Pick File",
    noFile: "No file selected",
    pyCode: "Python Code",
    runNow: "Run Now",
    running: "Running...",
    execResult: "Execution Result",
    status: "Status",
    stdout: "Stdout",
    stderr: "Stderr",
    artifacts: "Artifacts",
    view: "View",
    waiting: "Waiting to run.",
    reqFailed: "Request failed",
    providerFailed: "Provider fetch failed",
    noMatchModel: "No matching model",
    defaultModel: "Default Model",
    defaultHint: "When no provider credentials are set, you can still use the Default Model (requires OPENAI_API_KEY on the server)",
    // extra
    configModelFirst: "Please configure a model in Settings before using the workspace.",
    unnamed: "Untitled",
    needCode: "Please generate or enter Python code first.",
    configModelForChat: "Please configure a model in Settings.",
    patchCannotMerge: "Suggested changes cannot be auto-merged; please adjust manually.",
    needProviderModels: "Please configure default models per provider in Settings.",
    previewShow: "Show preview",
    previewHide: "Hide preview",
    previewToggleShow: "View preview",
    previewToggleHide: "Hide preview",
    uploaded: "Uploaded:",
    rowsLabel: "rows",
    colsLabel: "columns",
    csvSupport: "CSV / Excel supported",
    generating: "Generating...",
    genCode: "Generate Python code",
    taskIdLbl: "Task ID:",
    noOutput: "(no output)",
  },
};

export const settingsTexts = {
  zh: {
    title: "设置与集成",
    desc: "管理 API Key 与默认模型列表。配置会加密存储在服务器，仅当前账户可见。",
    apiTitle: "API Key 与模型配置",
    save: "保存 API 配置",
    saved: "API 配置信息已同步保存。",
    failed: "无法加载 API 配置，请稍后重试。",
    baseUrl: "自定义 API Base URL",
    modelList: "模型列表（逗号或换行分隔，留空使用默认）",
  },
  en: {
    title: "Settings & Integrations",
    desc: "Manage API keys and default model lists. Credentials are encrypted and stored per account on the server.",
    apiTitle: "API Keys & Models",
    save: "Save API Settings",
    saved: "API settings saved successfully.",
    failed: "Failed to load API settings. Please try again later.",
    baseUrl: "Custom API Base URL",
    modelList: "Models (comma or newline separated; leave empty to use defaults)",
  },
};

export const homeTexts = {
  zh: {
    featureTitle: "多模型智能协作",
    featureBody: "接入 OpenAI、Claude 及主流国内模型，快速对比代码生成效果。",
    ctaWorkspace: "立即体验工作台",
    ctaHistory: "查看历史记录",
    howTitle: "如何运作？",
    steps: [
      "输入科研问题：描述你的分析需求，可附带数据集信息。",
      "选择模型并生成代码：多模型 LLM 给出可执行的 Python 脚本与策略说明。",
      "沙箱执行：在隔离环境中运行代码，查看输出、图表与日志。",
      "迭代与沉淀：保存任务历史，复用提示模板，形成团队知识库。",
    ],
  },
  en: {
    featureTitle: "Multi‑model Collaboration",
    featureBody: "Connect OpenAI, Claude and domestic providers to compare generated code quickly.",
    ctaWorkspace: "Open Workspace",
    ctaHistory: "View History",
    howTitle: "How it works",
    steps: [
      "Describe your research task; optionally include dataset info.",
      "Pick a model and generate code: models return runnable Python plus strategy notes.",
      "Run in sandbox: execute safely and inspect outputs, charts and logs.",
      "Iterate and retain: save tasks, reuse prompts, build team knowledge.",
    ],
  },
};

export const historyTexts = {
  zh: {
    title: "历史记录",
    desc: "回顾每一次分析任务、对应模型、输出与运行状态。",
    fetchFailed: "无法获取历史记录",
    task: "任务",
    model: "模型",
    status: "状态",
    createdAt: "创建时间",
    summary: "摘要",
    action: "操作",
    loading: "正在加载...",
    empty: "暂无历史任务。",
    view: "查看",
    close: "关闭",
    detailFailed: "无法加载任务详情",
    // detail
    detailTaskId: "任务 ID：",
    createdAtOn: "创建于",
    modelLbl: "模型",
    statusLbl: "状态",
    datasetFile: "数据集文件",
    taskDesc: "任务描述",
    genCode: "生成的 Python 代码",
    stdoutLbl: "标准输出",
    stderrLbl: "错误日志",
    noOutput: "(无输出)",
    noError: "(无错误)",
  },
  en: {
    title: "History",
    desc: "Review each analysis task, model used, outputs and status.",
    fetchFailed: "Failed to fetch history",
    task: "Task",
    model: "Model",
    status: "Status",
    createdAt: "Created",
    summary: "Summary",
    action: "Action",
    loading: "Loading...",
    empty: "No history yet.",
    view: "View",
    close: "Close",
    detailFailed: "Failed to load task detail",
    // detail
    detailTaskId: "Task ID:",
    createdAtOn: "Created",
    modelLbl: "Model",
    statusLbl: "Status",
    datasetFile: "Dataset File",
    taskDesc: "Task Description",
    genCode: "Generated Python code",
    stdoutLbl: "Stdout",
    stderrLbl: "Stderr",
    noOutput: "(no output)",
    noError: "(no errors)",
  },
};

export const chatTexts = {
  zh: {
    title: "智能协作",
    subtitle: "与模型对话，请它分析日志、修改代码或给出建议。",
    empty: "向模型说明需求或粘贴错误日志开始对话。",
    applyToEditor: "应用到编辑器",
    thinking: "模型思考中...",
    placeholder: "向模型描述问题、错误日志或修改需求...",
    autoAttach: "会自动附加当前代码与最新输出。",
    send: "发送",
    sending: "发送中...",
  },
  en: {
    title: "Co-pilot",
    subtitle: "Chat with the model to analyze logs, modify code or give suggestions.",
    empty: "Describe your need or paste error logs to start.",
    applyToEditor: "Apply to editor",
    thinking: "Model is thinking...",
    placeholder: "Describe the issue, error logs or requested changes...",
    autoAttach: "Current code and latest output will be attached automatically.",
    send: "Send",
    sending: "Sending...",
  },
};

export const authTexts = {
  zh: {
    title: "账户登录 / 注册",
    desc: "注册账户后，可在浏览器中安全保存个人 API Key，并独立管理自己的分析记录。",
    loginTab: "已有账户登录",
    registerTab: "新用户注册",
    errorTitle: "操作失败",
    username: "用户名",
    usernamePh: "请输入用户名",
    email: "邮箱（可选）",
    emailPh: "name@example.com",
    password: "密码",
    passwordPh: "至少 8 位字符",
    confirm: "确认密码",
    confirmPh: "再次输入密码",
    submitting: "处理中...",
    login: "登录",
    register: "注册并登录",
    needUserPass: "请输入用户名和密码。",
    mismatch: "两次输入的密码不一致。",
    fallbackError: "操作失败，请稍后重试。",
  },
  en: {
    title: "Sign In / Register",
    desc: "After registering, you can securely store API keys in the browser and manage your analysis logs.",
    loginTab: "Sign In",
    registerTab: "Create Account",
    errorTitle: "Operation failed",
    username: "Username",
    usernamePh: "Enter username",
    email: "Email (optional)",
    emailPh: "name@example.com",
    password: "Password",
    passwordPh: "At least 8 characters",
    confirm: "Confirm Password",
    confirmPh: "Re-enter password",
    submitting: "Submitting...",
    login: "Sign In",
    register: "Register & Sign In",
    needUserPass: "Please enter username and password.",
    mismatch: "Passwords do not match.",
    fallbackError: "Operation failed. Please try again later.",
  },
};
